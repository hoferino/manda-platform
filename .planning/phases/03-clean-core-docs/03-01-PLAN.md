---
phase: 03-clean-core-docs
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - docs/manda-prd.md
  - docs/manda-architecture.md
  - .planning/phases/03-clean-core-docs/CHANGELOG.md
autonomous: true

must_haves:
  truths:
    - "PRD contains only current/accurate information relevant to active development"
    - "Architecture doc reflects actual current implementation"
    - "Both docs reference consolidated feature documentation in docs/features/"
    - "Removed content is documented with rationale"
  artifacts:
    - path: "docs/manda-prd.md"
      provides: "Cleaned PRD with outdated sections removed"
    - path: "docs/manda-architecture.md"
      provides: "Cleaned architecture doc with outdated sections removed"
    - path: ".planning/phases/03-clean-core-docs/CHANGELOG.md"
      provides: "Record of what was removed and why"
  key_links:
    - from: "docs/manda-prd.md"
      to: "docs/features/"
      via: "references for detailed feature documentation"
    - from: "docs/manda-architecture.md"
      to: "docs/features/"
      via: "references for detailed feature documentation"
---

<objective>
Clean outdated sections from manda-prd.md and manda-architecture.md

Purpose: Remove outdated/inaccurate sections from core docs to ensure single source of truth. Feature-specific details now live in docs/features/ (consolidated in Phase 2).

Output:
- Cleaned PRD and architecture docs
- CHANGELOG documenting what was removed and why
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@docs/features/agent-v2/README.md
@docs/features/knowledge-graph/README.md
@docs/features/cim-builder/README.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Review and clean manda-prd.md</name>
  <files>docs/manda-prd.md, .planning/phases/03-clean-core-docs/CHANGELOG.md</files>
  <action>
Review manda-prd.md and clean the following types of outdated content:

1. **Version/status inconsistencies to fix:**
   - Update frontmatter last-updated date
   - Review "Implementation Status" section - ensure it reflects actual completed work

2. **Sections to review for removal/simplification:**
   - "Architecture Decisions Made" - many are now implemented facts, not decisions to track
   - E11 planning details in "P0-P3" format - E11 is complete, simplify to just list what was done
   - Detailed feature descriptions that are now better documented in docs/features/
   - Open questions that have been resolved

3. **References to add:**
   - Add pointers to docs/features/agent-v2/ for agent implementation details
   - Add pointers to docs/features/knowledge-graph/ for KG details
   - Add pointers to docs/features/cim-builder/ for CIM details

4. **Create CHANGELOG entry documenting:**
   - What sections were removed/simplified
   - Rationale for each change
   - New reference locations

Keep PRD focused on REQUIREMENTS and HIGH-LEVEL ARCHITECTURE. Move detailed implementation to feature docs.

IMPORTANT: Do NOT delete information that would be lost - only remove duplicates or outdated content. When in doubt, keep it.
  </action>
  <verify>
- PRD still contains all functional requirements (FR-*)
- PRD still contains all non-functional requirements (NFR-*)
- PRD references docs/features/ for detailed implementation
- CHANGELOG.md documents changes with rationale
  </verify>
  <done>
manda-prd.md cleaned with outdated implementation details removed, references to feature docs added, and CHANGELOG documents all changes
  </done>
</task>

<task type="auto">
  <name>Task 2: Review and clean manda-architecture.md</name>
  <files>docs/manda-architecture.md, .planning/phases/03-clean-core-docs/CHANGELOG.md</files>
  <action>
Review manda-architecture.md and clean the following types of outdated content:

1. **Version/status inconsistencies to fix:**
   - Update frontmatter last-updated date
   - Version mentions "3-path LangGraph routing" in version string but that was deleted code

2. **Sections to review for removal/simplification:**
   - "Chat Orchestrator Architecture (v4.3)" section - this code was DELETED in Story 1.7 (see CLAUDE.md: "Legacy Code (Removed in Story 1.7)")
   - Remove/update references to `lib/agent/orchestrator/` files - they no longer exist
   - "Key Files" table listing orchestrator files that don't exist
   - Code examples referencing deleted orchestrator code
   - Detailed agent implementation that belongs in docs/features/agent-v2/

3. **Implementation Status table to verify:**
   - "Chat Orchestrator" row shows "3-path LangGraph (vanilla/retrieval/analysis)" but this is deleted
   - Update to reflect actual current state (v2 supervisor pattern)

4. **References to add:**
   - Add pointers to docs/features/agent-v2/ for agent architecture
   - Add pointers to docs/features/knowledge-graph/ for KG architecture
   - Add pointers to docs/features/cim-builder/ for CIM workflow

5. **Append to CHANGELOG documenting:**
   - What sections were removed/updated
   - Rationale (especially deleted code references)
   - New reference locations

IMPORTANT: Keep high-level architecture diagrams and decisions. Remove implementation details that:
- Reference deleted code
- Duplicate docs/features/ content
- Show "planned" work that's now complete
  </action>
  <verify>
- Architecture doc no longer references deleted orchestrator code
- Implementation status table reflects current state
- High-level diagrams retained
- Technology stack section accurate
- CHANGELOG.md updated with architecture changes
  </verify>
  <done>
manda-architecture.md cleaned with deleted code references removed, status tables accurate, and references to feature docs added
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify no broken references</name>
  <files>docs/manda-prd.md, docs/manda-architecture.md</files>
  <action>
After cleaning, verify no broken internal references:

1. Check all internal markdown links in both docs:
   - `[text](./path)` format links
   - `[text](path.md)` format links
   - References to other docs in the repo

2. Verify referenced files exist:
   - sprint-change-proposal-*.md files
   - architecture-decisions/ files
   - docs/features/ files

3. Check for orphaned references to deleted content:
   - No mentions of orchestrator/router.ts
   - No mentions of orchestrator/graph.ts
   - No mentions of paths/vanilla.ts, retrieval.ts, analysis.ts

4. If any broken references found, fix them:
   - Update link to correct location
   - Or remove reference if target no longer exists
   - Document any fixes in CHANGELOG
  </action>
  <verify>
Run grep for common broken patterns:
- `grep -r "orchestrator/" docs/manda-*.md` returns no matches
- `grep -r "paths/vanilla" docs/manda-*.md` returns no matches
- All markdown links resolve to existing files
  </verify>
  <done>
No broken internal references in core docs; any fixes documented in CHANGELOG
  </done>
</task>

</tasks>

<verification>
After all tasks:
- `wc -l docs/manda-prd.md` - reasonable length (may be shorter after cleanup)
- `wc -l docs/manda-architecture.md` - reasonable length (may be shorter after cleanup)
- `cat .planning/phases/03-clean-core-docs/CHANGELOG.md` - shows what was removed
- No grep matches for deleted code references
</verification>

<success_criteria>
1. manda-prd.md contains only current/accurate requirements and high-level architecture
2. manda-architecture.md contains only current/accurate implementation details
3. Both docs reference docs/features/ for detailed feature documentation
4. CHANGELOG.md documents all changes with clear rationale
5. No broken internal references
6. No references to deleted code (orchestrator, paths/)
</success_criteria>

<output>
After completion, create `.planning/phases/03-clean-core-docs/03-01-SUMMARY.md`
</output>
