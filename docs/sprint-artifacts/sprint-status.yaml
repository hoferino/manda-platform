# Sprint Status - Manda Platform Implementation
# Generated: 2025-11-25
# Last Updated: 2025-11-26
# Project: Manda
# Tracking System: file-system
# Story Location: docs/sprint-artifacts

# ===================
# BACKLOG ITEMS
# ===================
# Technical debt and action items from retrospectives
backlog:
  # From Epic 2 Retrospective (2025-11-26)
  - id: BL-001
    title: Add E2E tests for Data Room
    priority: medium
    source: epic-2-retrospective
    description: |
      No Playwright/Cypress E2E tests were created during Epic 2.
      Manual verification worked but doesn't scale.
      Consider adding E2E test story or including in DoD.

  - id: BL-002
    title: Add rate limiting on document endpoints
    priority: medium
    source: epic-2-retrospective
    description: |
      Document upload and download endpoints lack rate limiting.
      Required for production readiness to prevent abuse.
      Consider using middleware or API gateway.

  - id: BL-003
    title: Monitor GCS costs as usage grows
    priority: low
    source: epic-2-retrospective
    description: |
      Google Cloud Storage costs should be monitored as document volume increases.
      Set up billing alerts and consider lifecycle policies for old documents.

# generated: 2025-11-25
# project: Manda
# project_key: manda-platform
# tracking_system: file-system
# story_location: docs/sprint-artifacts

# STATUS DEFINITIONS:
# ==================
# Epic Status:
#   - backlog: Epic exists in epic file but not contexted
#   - contexted: Epic tech context created (required before drafting stories)
#
# Story Status:
#   - backlog: Story only exists in epic file
#   - drafted: Story file created in stories folder
#   - ready-for-dev: Draft approved and story context created
#   - in-progress: Developer actively working on implementation
#   - review: Under SM review (via code-review workflow)
#   - done: Story completed
#
# Retrospective Status:
#   - optional: Can be completed but not required
#   - completed: Retrospective has been done
#
# WORKFLOW NOTES:
# ===============
# - Epics should be 'contexted' before stories can be 'drafted'
# - Stories can be worked in parallel if team capacity allows
# - SM typically drafts next story after previous one is 'done' to incorporate learnings
# - Dev moves story to 'review', SM reviews, then Dev moves to 'done'

generated: 2025-11-24
project: Manda
project_key: manda-platform
tracking_system: file-system
story_location: docs/sprint-artifacts

development_status:
  # Epic 1: Project Foundation (9 stories) - COMPLETED 2025-11-25
  epic-1: done
  epic-1-jira-id: SCRUM-10
  epic-1-completed: 2025-11-25
  epic-1-notes: |
    All 9 stories completed. Key deliverables:
    - Next.js 15 with shadcn/ui, Tailwind CSS, TypeScript
    - Supabase Auth with SSR middleware, protected routes
    - PostgreSQL schema with RLS policies for multi-tenant isolation
    - Projects overview with search, filter, and pagination
    - 2-step project creation wizard (simplified from 3-step)
    - Project workspace shell with sidebar navigation
    - Neo4j graph database integration
    - pg-boss job queue with health monitoring
    - Audit logging for security events
    Architecture decisions:
    - Document storage: Google Cloud Storage (GCS) - decided for Epic 2
    - Test infrastructure: Vitest + React Testing Library (19 tests)
    - Error boundaries: Hierarchical error handling with recovery
  e1-1-set-up-nextjs-15-project-with-shadcnui: done
  e1-1-jira-id: SCRUM-11
  e1-2-configure-supabase-auth-and-database-connection: done
  e1-2-jira-id: SCRUM-12
  e1-3-create-postgresql-schema-with-rls-policies: done
  e1-3-jira-id: SCRUM-13
  e1-4-build-projects-overview-screen-landing: done
  e1-4-jira-id: SCRUM-14
  e1-5-implement-project-creation-wizard: done
  e1-5-jira-id: SCRUM-15
  e1-6-build-project-workspace-shell-with-navigation: done
  e1-6-jira-id: SCRUM-16
  e1-7-configure-neo4j-graph-database: done
  e1-7-jira-id: SCRUM-17
  e1-8-configure-pg-boss-job-queue: done
  e1-8-jira-id: SCRUM-18
  e1-9-implement-audit-logging-for-security-events: done
  e1-9-jira-id: SCRUM-19
  epic-1-retrospective: completed

  # Epic 2: Document Ingestion & Storage (8 stories) - Uses GCS (architecture decision 2025-11-25)
  # COURSE CORRECTION v2.6 (2025-11-26):
  # - Unified bucket/folder model: folder_path is single source of truth
  # - Buckets = top-level folders (same data, different view)
  # - Removed deal_type from wizard (didn't drive behavior)
  # - Empty projects have empty data rooms (no default buckets)
  # - Removed category column from documents table
  epic-2: done
  epic-2-jira-id: SCRUM-21
  epic-2-completed: 2025-11-26
  e2-1-implement-document-upload-to-google-cloud-storage: done
  e2-1-jira-id: SCRUM-22
  e2-1-completed: 2025-11-25
  e2-2-build-data-room-folder-structure-view: done
  e2-2-completed: 2025-11-25
  e2-2-jira-id: SCRUM-23
  e2-3-build-data-room-buckets-view-category-based: done
  e2-3-completed: 2025-11-25
  e2-3-jira-id: SCRUM-24
  e2-3-refactored: 2025-11-26  # v2.6: Refactored to derive buckets from folder_path, removed hardcoded categories
  e2-4-implement-view-toggle-and-user-preference: done
  e2-4-jira-id: SCRUM-25
  e2-4-completed: 2025-11-26
  e2-5-create-document-metadata-management: done
  e2-5-jira-id: SCRUM-26
  e2-5-completed: 2025-11-26
  e2-6-implement-document-actions-view-download-delete: done
  e2-6-jira-id: SCRUM-27
  e2-6-completed: 2025-11-26
  e2-6-reviewed: 2025-11-26
  e2-7-build-upload-progress-indicators-and-websocket-updates: done
  e2-7-jira-id: SCRUM-28
  e2-7-completed: 2025-11-26
  e2-8-implement-irl-integration-with-document-tracking: done
  e2-8-jira-id: SCRUM-29
  e2-8-completed: 2025-11-26
  epic-2-retrospective: completed
  epic-2-notes: |
    All 8 stories completed. Key deliverables:
    - Google Cloud Storage integration with signed URLs
    - Data Room with Folder and Bucket views (unified model)
    - Virtual folders derived from folder_path (no separate table)
    - Drag-and-drop document management
    - Upload progress with Zustand store and parallel uploads
    - IRL Checklist panel for document tracking
    - 135 tests (7x growth from Epic 1)
    Architecture decisions:
    - Buckets = top-level folders (v2.6 course correction)
    - XHR for upload progress (Fetch API limitation)
    - Zustand + localStorage for upload persistence

  # Epic 3: Intelligent Document Processing (9 stories)
  # CONTEXTED: 2025-11-26
  # Tech Spec: docs/sprint-artifacts/tech-spec-epic-E3.md
  # Key Decisions:
  # - FastAPI Python backend (manda-processing service)
  # - Tiered Gemini 2.5: Flash (extraction), Pro (deep analysis), Flash-Lite (batch)
  # - pgvector for embeddings (staying with Supabase for MVP)
  # - Docling for document parsing with OCR
  # - 3 new tables: document_chunks, findings, financial_metrics
  epic-3: contexted
  epic-3-jira-id: SCRUM-30
  epic-3-contexted: 2025-11-26
  epic-3-tech-spec: docs/sprint-artifacts/tech-spec-epic-E3.md
  epic-3-preparation:
    - FastAPI service setup for Python processing pipeline
    - Reuse Zustand patterns for processing queue state
    - WebSocket infrastructure for real-time status updates
    - Consider batch processing for multiple documents
  e3-1-set-up-fastapi-backend-with-pg-boss-job-queue: done
  e3-1-jira-id: SCRUM-31
  e3-1-drafted: 2025-11-26
  e3-1-context-ready: 2025-11-26
  e3-1-completed: 2025-11-26
  e3-1-reviewed: 2025-11-26
  e3-1-notes: |
    FastAPI backend created with pg-boss job queue integration.
    79 tests passing with 93% coverage. Python 3.12+ required.
    Direct SQL approach for pg-boss compatibility with TypeScript.
    Code review APPROVED - all 6 ACs verified, no HIGH/MEDIUM issues.
  e3-2-integrate-docling-for-document-parsing: done
  e3-2-jira-id: SCRUM-32
  e3-2-drafted: 2025-11-26
  e3-2-completed: 2025-11-26
  e3-2-reviewed: 2025-11-26
  e3-2-notes: |
    Docling integration completed with comprehensive parser module.
    136 tests passing (24 skipped for docling-dependent tests).
    Coverage: chunker.py 87%, excel_parser.py 89%, __init__.py 96%.
    Code review APPROVED - all 6 ACs verified, no HIGH/MEDIUM blocking issues.
    Key deliverables:
    - Parser interface with Pydantic models (ChunkData, TableData, FormulaData, ParseResult)
    - Excel parser with formula preservation (openpyxl)
    - PDF parser with OCR support (Docling)
    - Semantic chunking (512-1024 tokens, tiktoken)
    - Documentation at manda-processing/docs/parsers.md
  e3-3-implement-document-parsing-job-handler: done
  e3-3-jira-id: SCRUM-33
  e3-3-drafted: 2025-11-26
  e3-3-completed: 2025-11-27
  e3-3-notes: |
    Document parsing job handler completed. Key deliverables:
    - ParseDocumentHandler class with GCS download, parsing, DB storage
    - Webhook endpoint for triggering parse jobs (/webhooks/document-uploaded)
    - Atomic transaction: store chunks + update status in single transaction
    - Error handling: GCS errors, parse errors, DB errors with retry classification
    - 137 tests passing with 84% coverage on new code
    Key files:
    - src/jobs/handlers/parse_document.py - Main handler
    - src/storage/gcs_client.py - GCS download with retry
    - src/storage/supabase_client.py - DB operations for chunks
    - src/api/routes/webhooks.py - Webhook endpoints
    - migrations/00015_create_document_chunks_table.sql - Chunks table
  e3-4-generate-embeddings-for-semantic-search: backlog
  e3-4-jira-id: SCRUM-34
  e3-5-implement-llm-analysis-with-gemini-25-tiered: backlog
  e3-5-jira-id: SCRUM-35
  e3-6-create-processing-status-tracking-and-websocket-updates: backlog
  e3-6-jira-id: SCRUM-36
  e3-7-implement-processing-queue-visibility: backlog
  e3-7-jira-id: SCRUM-37
  e3-8-implement-retry-logic-for-failed-processing: backlog
  e3-8-jira-id: SCRUM-38
  e3-9-financial-model-integration-extract-and-query-financial-metrics: backlog
  e3-9-jira-id: SCRUM-39
  epic-3-retrospective: optional

  # Epic 4: Collaborative Knowledge Workflow (14 stories)
  epic-4: backlog
  e4-1-build-knowledge-explorer-ui-main-interface: backlog
  e4-2-implement-findings-tab-with-filtering-and-validation: backlog
  e4-3-implement-entities-tab-for-named-entity-browsing: backlog
  e4-4-implement-patterns-tab-for-cross-domain-intelligence: backlog
  e4-5-implement-contradictions-tab-with-conflict-resolution: backlog
  e4-6-build-finding-detail-view-with-source-attribution: backlog
  e4-7-implement-chat-based-finding-capture: backlog
  e4-8-implement-excel-word-notes-upload-for-finding-extraction: backlog
  e4-9-implement-collaborative-analysis-mode-analyst-reads-tells-agent: backlog
  e4-10-implement-finding-validation-workflow: backlog
  e4-11-implement-contradiction-detection-and-flagging: backlog
  e4-12-build-bulk-actions-for-finding-management: backlog
  e4-13-implement-export-findings-feature: backlog
  e4-14-build-real-time-knowledge-graph-updates: backlog
  epic-4-retrospective: optional

  # Epic 5: Conversational Assistant (8 stories)
  epic-5: backlog
  e5-1-build-chat-interface-ui-with-message-history: backlog
  e5-2-implement-langgraph-agent-orchestration: backlog
  e5-3-implement-12-agent-tools-for-knowledge-querying: backlog
  e5-4-implement-streaming-response-with-websocket: backlog
  e5-5-implement-conversation-persistence-and-history: backlog
  e5-6-implement-source-citation-in-responses: backlog
  e5-7-build-suggested-questions-feature: backlog
  e5-8-implement-chat-export-functionality: backlog
  epic-5-retrospective: optional

  # Epic 6: IRL Management & Auto-Generation (8 stories)
  epic-6: backlog
  e6-1-build-irl-builder-ui-with-template-selection: backlog
  e6-2-implement-irl-creation-and-editing: backlog
  e6-3-implement-ai-assisted-irl-auto-generation-from-documents: backlog
  e6-4-implement-data-room-folder-structure-auto-generation-from-irl: backlog
  e6-5-implement-irl-document-linking-and-progress-tracking: backlog
  e6-6-build-irl-export-functionality-excel-csv: backlog
  e6-7-implement-irl-templates-library: backlog
  e6-8-build-irl-checklist-progress-visualization: backlog
  epic-6-retrospective: optional

  # Epic 7: Learning Loop (6 stories)
  epic-7: backlog
  e7-1-implement-feedback-capture-mechanism: backlog
  e7-2-build-feedback-storage-and-analysis-pipeline: backlog
  e7-3-implement-prompt-optimization-based-on-feedback: backlog
  e7-4-build-feedback-analytics-dashboard: backlog
  e7-5-implement-pattern-recognition-from-corrections: backlog
  e7-6-build-feedback-export-for-model-fine-tuning: backlog
  epic-7-retrospective: optional

  # Epic 8: Q&A Co-Creation Workflow (8 stories)
  epic-8: backlog
  e8-1-build-qa-list-builder-ui: backlog
  e8-2-implement-ai-assisted-question-generation: backlog
  e8-3-implement-answer-drafting-with-source-citations: backlog
  e8-4-build-collaborative-qa-editing-workflow: backlog
  e8-5-implement-qa-organization-and-categorization: backlog
  e8-6-build-qa-export-word-pdf: backlog
  e8-7-implement-qa-version-control: backlog
  e8-8-build-qa-templates-library: backlog
  epic-8-retrospective: optional

  # Epic 9: CIM Company Overview Creation (CIM v3 Workflow) (9 stories)
  epic-9: backlog
  e9-1-cim-workflow-database-schema-and-state-management: backlog
  e9-2-cim-builder-ui-with-workflow-progress-visualization-and-live-preview: backlog
  e9-3-agent-tool-suggest-narrative-outline: backlog
  e9-4-langgraph-cim-v3-workflow-implementation-14-phases: backlog
  e9-5-content-first-then-visual-workflow: backlog
  e9-6-extreme-visual-precision-generation-and-validation: backlog
  e9-7-continuous-balance-checks-and-coherence-validation: backlog
  e9-8-non-linear-workflow-and-special-commands: backlog
  e9-9-multi-format-export-with-rag-source-citations: backlog
  epic-9-retrospective: optional
